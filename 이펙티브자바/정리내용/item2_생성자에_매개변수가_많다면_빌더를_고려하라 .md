## item2. 생성자에 매개변수가 많다면 빌더를 고려하라

클래스가 가지고있는 여러 필드들 중에 일부는 필수적이고 또 일부는 필수가 아닌것들이 있을때
객체를 생성하기 위해서 어떻게 해야할까?

### 1. 생성자에 넘겨주는 파라미터가 어떤것들이냐에 따라서 여러 생성자들을 만들기
- 장점 : 객체를 만들때 기본적인 값은 반드시 받아서 만들도록 강제할수 있다. 
- 단점 : 중복, 코드 지저분

### 2. 점층적 생성자 패턴(=생성자 체이닝)
- 매개변수가 적은쪽에서 매개변수가 많은쪽의 생성자를 this로 호출을 해주는 방식
- 단점 : 생성자의 몇번째 파라미터가 무슨 필드값인지를 전부 파악하고있기가 어려우므로 코드 작성 및 읽기가 어려움

### 3. java beans 패턴
- 기본생성자로 객체를 만든 후 setter를 통해 원하는 필드 값을 설정하는 방식
- 장점 : 객체 생성이 간단
- 단점 : setter를 여러번 호출해야함, 어디까지가 필수세팅인지 파악 어려움, 원하는 값을 만들기 위한 setter를 전부 호출하기 전까지 객체가 불안정한 상태에 놓이게 됨(아직 setter를 전부 호출하지 않았는데 중간에 해당 객체를 사용한다면?)

### 4. 점층적 생성자패턴 + java beans 패턴 혼용
- 필수값은 생성자로, 선택값은 setter로
- 단점 : 불변객체로 만들기가 어렵다(java17 record)

### 5. 빌더패턴 < 책에서 권장
- 빌더의 생성자에는 필수로 받아야하는값을, 선택적 필드는 셋터역할을 하는 메서드로 셋팅하는 방식
- 장점 : setter역할을 하는 메서드들이 빌더타입을 리턴해줘서 메서드 체이닝 가능,  
반드시 build 메서드를 마지막에 호출해야 해당 객체를 사용할수 있어서 안정적,  
계층적으로 설계된 클래스와 함께 쓰기 좋음
- 단점 : 직접 빌더를 만들면 필드 중복 -> 롬복 @Builder -> 생성자에 필수값을 지정해줄수가 없음


### 계층적으로 설계된 클래스에서의 빌더패턴
빌더 패턴은 계층적으로 설계된 클래스와 함께 쓰기 좋다.  
추상 클래스는 추상 빌더를, 구체 클래스는 구체 빌더를 갖음.  
추상클래스에 있는 추상빌더는 빌더자신의 하위클래스타입을 받도록 **재귀적인 타입제한**사용하고
여기에 추상 메서드인 self를 만들어서 T타입을 리턴할수있게 하여서  
타입캐스팅없이 하위빌더들을 활용해서 코드를 유용하게 작성하도록 할수있습니다.  
(원래는 this를 리턴했었는데 상속구조가 되면서 추상 Builder가 this를 리턴하면 자기자신을 리턴하게되니까 NyPizza를 타입캐스팅을 한번 더 해줘야하는 불편함)
이렇게 하위 클래스의 메서드가 상위 클래스의 메서드가 정의한 반환 타입이 아닌, 
그 하위 타입을 반환하는 기능을 공변 반환 타이핑(covariant return typing)이라 한다. 
이 기능을 시용하면 클라이언트가 형 변환에 신경 쓰지 않고도 빌더를 사용할 수 있다.  

### 핵심정리
생성자나 정적팩터리가 처리해야할 매개변수가 많다면 빌더패턴을 선택하는게 더 낫다.  
매개변수 중 다수가 필수가 아니거나 같은 타입일 경우 더 그렇다.  
빌더는 점층적 생성자보다 코드를 읽고 쓰기가 훨씬 간결하고, 자바빈즈보다 훨씬 안전하다.
